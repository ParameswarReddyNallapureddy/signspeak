<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SignSpeak</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
       <style>
         button{
 padding:10px 20px;margin-top:15px;
}
       </style>
</head>
<body>
    <a href="/profile" class="profile-icon">ðŸ‘¤</a>

<div class="page">
    <div class="main-app"> <h1>ðŸ¤Ÿ SignSpeak</h1>
        <p class="subtitle">Text to Sign Language Avatar</p>

        <div class="search-box">
            <input id="textInput" placeholder="Try: hello, thankful, thinking, cry, amazing">
            
            <button id="micButton" onclick="startSpeechRecognition()" title="Voice Input">
                <i class="fas fa-microphone"></i>
            </button>
            
            <button onclick="translateAndAnimate()">Animate</button>
        </div>
        
        <p id="micStatus" class="status" style="color: #4dc2f6; min-height: 10px; font-style: italic;"></p>

        <p id="status" class="status"></p>

        <div id="videoContainer"></div>
        

       <a href="/dashboard"><button>â¬… Back</button></a>
    </div>
  
</div>

<script src="{{ url_for('static', filename='translator.js') }}"></script>
<script>
    // --- Voice-to-Sign Logic ---
    const micButton = document.getElementById('micButton');
    const textInput = document.getElementById('textInput');
    const micStatus = document.getElementById('micStatus');

    function startSpeechRecognition() {
        // Check for browser support
        if (!('webkitSpeechRecognition' in window)) {
            micStatus.innerHTML = "âŒ Voice input not supported by your browser.";
            return;
        }

        const recognition = new webkitSpeechRecognition();
        recognition.continuous = false;
        recognition.interimResults = false;
        recognition.lang = 'en-US'; // Set language

        micButton.disabled = true;
        micStatus.innerHTML = "ðŸŽ§ Listening... speak now.";
        
        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            textInput.value = transcript;
            micStatus.innerHTML = `Recognized: "${transcript}"`;
            
            // Auto-trigger the translation after successful recognition
            translateAndAnimate(); 
        };

        recognition.onerror = (event) => {
            micStatus.innerHTML = `âŒ Error: ${event.error}. Try again.`;
            micButton.disabled = false;
        };
        
        recognition.onend = () => {
            micButton.disabled = false;
            if (micStatus.innerHTML === "ðŸŽ§ Listening... speak now.") {
                 micStatus.innerHTML = "ðŸ›‘ No speech detected.";
            }
        };

        recognition.start();
    }
</script>
</body>
</html>